<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/embedded_ccpp/libs/highlight/github.min.css"> <link rel=stylesheet  href="/embedded_ccpp/css/franklin.css"> <link rel=stylesheet  href="/embedded_ccpp/css/poole_hyde.css"> <link rel=stylesheet  href="/embedded_ccpp/css/custom.css"> <style> html {font-size: 17px;} .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;} @media (min-width: 940px) { .franklin-content {width: 100%; margin-left: auto; margin-right: auto;} } @media (max-width: 968px) { .franklin-content {padding-left: 6%; padding-right: 6%;} } </style> <link rel=icon  href="/embedded_ccpp/assets/c.svg"> <title>Compiling C/C++ for Host with PlatformIO</title> <div class=sidebar > <div class="container sidebar-sticky"> <div class=sidebar-about > <br> <img src="/embedded_ccpp/assets/KuwaitUniversityLogoTextLight.svg" style="width: 200px; height: auto; display: inline"> <h1 style="font-size:2em; opacity: 0.75;"><a href="/embedded_ccpp/">C/C++</a></h1> <p class=lead >Introduction to Embedded C/C++</p> </div> <script> function hidePart(part_div) { var x = document.getElementById(part_div); if (x.style.display === "none") { x.style.display = "block"; } else { x.style.display = "none"; } } </script> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/embedded_ccpp/">Home</a> <a class="sidebar-nav-item " href="https://alsaibie.github.io/me319">ME319 Mechatronics Course</a> <br> <small style="text-transform: uppercase; font-size: 0.75em">Lessons</small> <div class=part  onclick="hidePart('part1_div')">Fundamentals</div> <div id=part1_div  style="display:none;"> <a class="sidebar-nav-item " href="/embedded_ccpp/part_i/introduction/"><b>L0</b> <em>Introduction</em></a> <a class="sidebar-nav-item " href="/embedded_ccpp/part_i/lesson1/"><b>L1</b> <em>C and C++</em></a> <a class="sidebar-nav-item " href="/embedded_ccpp/part_i/lesson2/"><b>L2</b> <em>File and Program Structure</em></a> <a class="sidebar-nav-item " href="/embedded_ccpp/part_i/lesson3/"><b>L3</b> <em>Data Types</em></a> <a class="sidebar-nav-item " href="/embedded_ccpp/part_i/lesson4/"><b>L4</b> <em>Variables</em></a> <a class="sidebar-nav-item " href="/embedded_ccpp/part_i/lesson5/"><b>L5</b> <em>Arrays</em></a> <a class="sidebar-nav-item " href="/embedded_ccpp/part_i/lesson6/"><b>L6</b> <em>Type Qualifiers and Storage Specifiers</em></a> <a class="sidebar-nav-item " href="/embedded_ccpp/part_i/lesson7/"><b>L7</b> <em>Operations</em></a> <a class="sidebar-nav-item " href="/embedded_ccpp/part_i/lesson8/"><b>L8</b> <em>Control Structures</em></a> <a class="sidebar-nav-item " href="/embedded_ccpp/part_i/lesson9/"><b>L9</b> <em>Functions</em></a> <a class="sidebar-nav-item " href="/embedded_ccpp/part_i/lesson10/"><b>L10</b> <em>Pointers and References</em></a> <a class="sidebar-nav-item " href="/embedded_ccpp/part_i/lesson11/"><b>L11</b> <em>Structs</em></a> <a class="sidebar-nav-item " href="/embedded_ccpp/part_i/lesson12/"><b>L12</b> <em>Classes</em></a> <a class="sidebar-nav-item " href="/embedded_ccpp/part_i/lesson13/"><b>L13</b> <em>Strings</em></a> <a class="sidebar-nav-item " href="/embedded_ccpp/part_i/lesson14/"><b>L14</b> <em>Preprocessor Directives</em></a> <a class="sidebar-nav-item " href="/embedded_ccpp/part_i/lesson15/"><b>L15</b> <em>Standard Library</em></a> <a class="sidebar-nav-item " href="/embedded_ccpp/part_i/lesson16/"><b>L16</b> <em>C/C++ Process Flow</em></a> <a class="sidebar-nav-item " href="/embedded_ccpp/part_i/lesson17/"><b>L17</b> <em>Debugging</em></a> </div> <!-- <div class=part  onclick="hidePart('part2_div')">Embedded Applications</div> <div id=part2_div  style="display:none;"> <a class="sidebar-nav-item {{ispage /part_ii/lesson1/}}active{{end}}" href="/embedded_ccpp/part_ii/lesson1/"><b>L1</b> <em>Event-Drive Programming</em></a> <a class="sidebar-nav-item {{ispage /part_ii/lesson2/}}active{{end}}" href="/embedded_ccpp/part_ii/lesson2/"><b>L2</b> <em>Threads</em></a> <a class="sidebar-nav-item {{ispage /part_ii/lesson3/}}active{{end}}" href="/embedded_ccpp/part_ii/lesson3/"><b>L3</b> <em>Interrupts</em></a> <a class="sidebar-nav-item {{ispage /part_ii/lesson3/}}active{{end}}" href="/embedded_ccpp/part_ii/lesson3/"><b>L4</b> <em>Scheduling</em></a> <a class="sidebar-nav-item {{ispage /part_ii/lesson3/}}active{{end}}" href="/embedded_ccpp/part_ii/lesson3/"><b>L5</b> <em>Real-Time Control</em></a> <a class="sidebar-nav-item {{ispage /part_ii/lesson3/}}active{{end}}" href="/embedded_ccpp/part_ii/lesson3/"><b>L6</b> <em>Filters and Digital Controllers</em></a> <a class="sidebar-nav-item {{ispage /part_ii/lesson3/}}active{{end}}" href="/embedded_ccpp/part_ii/lesson3/"><b>L7</b> <em>Object-Oriented Device Libraries</em></a> <a class="sidebar-nav-item {{ispage /part_ii/lesson3/}}active{{end}}" href="/embedded_ccpp/part_ii/lesson3/"><b>L8</b> <em>State-Machine</em></a> </div> <div class=part  onclick="hidePart('part3_div')">Code Optimization</div> <div id=part3_div  style="display:none;"> <a class="sidebar-nav-item {{ispage /part_iii/lesson1/}}active{{end}}" href="/embedded_ccpp/part_iii/lesson1/"><b>L1</b> <em>Variable Sizes</em></a> <a class="sidebar-nav-item {{ispage /part_iii/lesson2/}}active{{end}}" href="/embedded_ccpp/part_iii/lesson2/"><b>L2</b> <em>Probabilistic Priority</em></a> <a class="sidebar-nav-item {{ispage /part_iii/lesson3/}}active{{end}}" href="/embedded_ccpp/part_iii/lesson3/"><b>L3</b> <em>Jumps and Branches</em></a> <a class="sidebar-nav-item {{ispage /part_iii/lesson4/}}active{{end}}" href="/embedded_ccpp/part_iii/lesson4/"><b>L4</b> <em>Loop Jamming</em></a> <a class="sidebar-nav-item {{ispage /part_iii/lesson4/}}active{{end}}" href="/embedded_ccpp/part_iii/lesson4/"><b>L5</b> <em>Integer vs. Floating Point Math</em></a> <a class="sidebar-nav-item {{ispage /part_iii/lesson4/}}active{{end}}" href="/embedded_ccpp/part_iii/lesson4/"><b>L6</b> <em>Pass by Reference</em></a> <a class="sidebar-nav-item {{ispage /part_iii/lesson4/}}active{{end}}" href="/embedded_ccpp/part_iii/lesson4/"><b>L7</b> <em>Reduce Expensive Math</em></a> </div> --> <!-- <div class=part  onclick="hidePart('part4_div')">Arduino API</div> <div id=part4_div  style="display:none;"> <a class="sidebar-nav-item {{ispage /part_iv/lesson1/}}active{{end}}" href="/embedded_ccpp/part_iv/lesson1/"><b>L1</b> <em>Overview</em></a> <a class="sidebar-nav-item {{ispage /part_iv/lesson2/}}active{{end}}" href="/embedded_ccpp/part_iv/lesson2/"><b>L2</b> <em>Program Structure</em></a> <a class="sidebar-nav-item {{ispage /part_iv/lesson3/}}active{{end}}" href="/embedded_ccpp/part_iv/lesson3/"><b>L3</b> <em>Blinky Example</em></a> <a class="sidebar-nav-item {{ispage /part_iv/lesson4/}}active{{end}}" href="/embedded_ccpp/part_iv/lesson4/"><b>L4</b> <em>Input Output Example</em></a> <a class="sidebar-nav-item {{ispage /part_iv/lesson5/}}active{{end}}" href="/embedded_ccpp/part_iv/lesson5/"><b>L5</b> <em>Arduino Library</em></a> <a class="sidebar-nav-item {{ispage /part_iv/lesson6/}}active{{end}}" href="/embedded_ccpp/part_iv/lesson6/"><b>L6</b> <em>Custom Library</em></a> </div> --> <small style="text-transform: uppercase; font-size: 0.75em">Tutorials</small> <div class=part  onclick="hidePart('vscode_setup_div')">IDE Setup</div> <div id=vscode_setup_div  style="display:none;"> <a class="sidebar-nav-item " href="/embedded_ccpp/ide_setups/introduction/"> <em>Introduction</em></a> <a class="sidebar-nav-item active" href="/embedded_ccpp/ide_setups/pio_for_host/"> <em>Compiling C/C++ for Host</em></a> </div> </nav> <p>&copy; Ali AlSaibie, PhD.</p> </div> </div> <div class="content container"> <div class=franklin-content ><h1 id=compiling_cc_for_host_with_platformio ><a href="#compiling_cc_for_host_with_platformio" class=header-anchor >Compiling C/C&#43;&#43; for Host with PlatformIO</a></h1> <p>The PlatformIO extension is targeted for building and flashing code into microcontrollers. It can also setup a compiler for host PC &#40;Windows&#41;. This tutorial shows you how to do that.</p> <h2 id=prerequisites ><a href="#prerequisites" class=header-anchor >Prerequisites</a></h2> <p>Make sure you have installed the latest <a href="https://code.visualstudio.com/Download">VSCode</a>. In addition to the following extensions</p> <ul> <li><p>PlatformIO</p> <li><p>Code Runner</p> </ul> <h2 id=installing_mingw ><a href="#installing_mingw" class=header-anchor >Installing MinGW</a></h2> <p>MinGW is a Windows port of the GNU Compiler Collection &#40;GCC&#41;. GCC comes with compilers for a wide range of systems including many microcontrollers. You can download and install it separately from <a href="https://sourceforge.net/projects/mingw/">MinGW</a> download site. But we can install a slimmer version using PlatformIO. </p> <p>Start VSCode, and click on the Alien icon on the left for PlatformIO tab, and click on PlatformIO Core CLI &#40;Platform IO Command Line Interface&#41;. </p> <center><img src="/embedded_ccpp/assets/ide_setups/pio_for_host/media/PIOTab.jpg" style="max-width:420px"></center> <p>A new terminal window will open within VSCode. Type <code>pio -h</code> and help commands for the pio cli will be printed. </p> <center><img src="/embedded_ccpp/assets/ide_setups/pio_for_host/media/pio_help.jpg" style="max-width:620px"></center> <p>We want to install the required tools for compiling to Windows. </p> <p>Type in the following command in the PIO CLI</p> <pre><code class="julia hljs">&gt;pio platform install windows_x86</code></pre>
<p>This will install the required packages to compile C/C&#43;&#43; for you host PC &#40;Windows&#41;. It will install the minGW binaries in the following directory. </p>
<code>&#123;HOME&#125;\.platformio\packages\toolchain-gccmingw32\bin</code>
<p>Where <code>&#123;HOME&#125;</code> is where your user directory is, for standard installations of PlatformIO.</p>

<center><img src="/embedded_ccpp/assets/ide_setups/pio_for_host/media/mingw_bin_dir.jpg" style="max-width:720px"></center>
<p>Now we want to add this MinGW binary directory to the environment path, so when we call the C&#43;&#43; compiler command <code>g&#43;&#43;</code> the system knows where it exists. </p>
<p>Click the start menu and search for and open &quot;Edit System Environment Variables&quot;. Then click on &quot;Environment Variables...&quot; 
<center><img src="/embedded_ccpp/assets/ide_setups/pio_for_host/media/edit_environ_variables.jpg" style="max-width:720px"></center></p>
<p>Under user variables. Go to <strong>Path</strong> variables and click edit. 
<center><img src="/embedded_ccpp/assets/ide_setups/pio_for_host/media/env_user_variables.jpg" style="max-width:720px"></center> </p>
<p>Then click <strong>New</strong> to add a new directory to path. The directories under Path are where the system searches for any command you try to execute in the terminal, including the terminal inside VSCode. 
<center><img src="/embedded_ccpp/assets/ide_setups/pio_for_host/media/Path_edit.jpg" style="max-width:720px"></center> </p>
<p>And past the bin directory for the MinGW tools. If you&#39;ve installed MinGW separately, you can follow the same steps to add the bin directory to the path. </p>
<p>Save and close the Environment Variables editing window. Then make sure you close all instances of VSCode and restart it. </p>
<p>After you start VSCode, open a terminal tab. You can press <code>ctrl&#43;J</code> to open the existing terminal tab, or start a new terminal from the top menu in VSCode. </p>
<p>To verify that VSCode can reach the g&#43;&#43; compiler, type</p>
<pre><code class="julia hljs">&gt;g++ -v</code></pre>
<p>And you should get the version of g&#43;&#43; installed. </p>
<p>
<center><img src="/embedded_ccpp/assets/ide_setups/pio_for_host/media/gppversion.jpg" style="max-width:780px"></center> </p>
<p>You could verify where it found the binary by typing the following</p>
<pre><code class="julia hljs">&gt;<span class=hljs-keyword >where</span> g++</code></pre>
<h2 id=creating_a_new_cc_project ><a href="#creating_a_new_cc_project" class=header-anchor >Creating a new C/C&#43;&#43; project</a></h2>
<p>There are several ways to create a new C/C&#43;&#43; project, we will present two. </p>
<h3 id=platformio_project ><a href="#platformio_project" class=header-anchor >PlatformIO Project</a></h3>
<h3 id=bare_vscode ><a href="#bare_vscode" class=header-anchor >Bare VSCode</a></h3>
<div class=page-foot >
  <div class=copyright >
    &copy; Ali AlSaibie, PhD. Last modified: April 06, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>
    </div>  
    
    
        
<script src="/embedded_ccpp/libs/highlight/highlightjs-line-numbers.js"></script>